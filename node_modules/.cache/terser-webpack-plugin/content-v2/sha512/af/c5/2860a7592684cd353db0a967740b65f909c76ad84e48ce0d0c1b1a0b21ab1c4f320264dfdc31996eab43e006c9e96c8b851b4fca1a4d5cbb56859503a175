{"code":"!function(e){var t={};function o(n){if(t[n])return t[n].exports;var c=t[n]={i:n,l:!1,exports:{}};return e[n].call(c.exports,c,c.exports,o),c.l=!0,c.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var c in e)o.d(n,c,function(t){return e[t]}.bind(null,c));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,\"a\",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p=\"\",o(o.s=0)}([function(e,t){const o=document.getElementById(\"startButton\"),n=document.getElementById(\"callButton\"),c=document.getElementById(\"hangupButton\");let i;n.disabled=!0,c.disabled=!0,o.addEventListener(\"click\",async function(){console.log(\"Requesting local stream\"),o.disabled=!0;try{const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0});console.log(\"Received local stream\"),a.srcObject=e,l=e,n.disabled=!1}catch(e){alert(`getUserMedia() error: ${e.name}`)}}),n.addEventListener(\"click\",async function(){n.disabled=!0,c.disabled=!1,console.log(\"Starting call\"),i=window.performance.now();const e=l.getVideoTracks(),t=l.getAudioTracks();e.length>0&&console.log(`Using video device: ${e[0].label}`);t.length>0&&console.log(`Using audio device: ${t[0].label}`);const o=function(){const e=document.querySelector(\"#sdpSemantics\"),t=e.options[e.selectedIndex];return\"\"===t.value?{}:{sdpSemantics:t.value}}();console.log(\"RTCPeerConnection configuration:\",o),d=new RTCPeerConnection(o),console.log(\"Created local peer connection object pc1\"),d.addEventListener(\"icecandidate\",e=>y(d,e)),r=new RTCPeerConnection(o),console.log(\"Created remote peer connection object pc2\"),r.addEventListener(\"icecandidate\",e=>y(r,e)),d.addEventListener(\"iceconnectionstatechange\",e=>b(d,e)),r.addEventListener(\"iceconnectionstatechange\",e=>b(r,e)),r.addEventListener(\"track\",h),l.getTracks().forEach(e=>d.addTrack(e,l)),console.log(\"Added local stream to pc1\");try{console.log(\"pc1 createOffer start\");const e=await d.createOffer(u);await async function(e){console.log(`Offer from pc1\\n${e.sdp}`),console.log(\"pc1 setLocalDescription start\");try{await d.setLocalDescription(e),p(d)}catch(e){v()}console.log(\"pc2 setRemoteDescription start\");try{await r.setRemoteDescription(e),m(r)}catch(e){v()}console.log(\"pc2 createAnswer start\");try{const e=await r.createAnswer();await async function(e){console.log(`Answer from pc2:\\n${e.sdp}`),console.log(\"pc2 setLocalDescription start\");try{await r.setLocalDescription(e),p(r)}catch(e){v(e)}console.log(\"pc1 setRemoteDescription start\");try{await d.setRemoteDescription(e),m(d)}catch(e){v(e)}}(e)}catch(e){f(e)}}(e)}catch(e){f(e)}}),c.addEventListener(\"click\",function(){console.log(\"Ending call\"),d.close(),r.close(),d=null,r=null,c.disabled=!0,n.disabled=!1});const a=document.getElementById(\"localVideo\"),s=document.getElementById(\"remoteVideo\");let l,d,r;a.addEventListener(\"loadedmetadata\",function(){console.log(`Local video videoWidth: ${this.videoWidth}px,  videoHeight: ${this.videoHeight}px`)}),s.addEventListener(\"loadedmetadata\",function(){console.log(`Remote video videoWidth: ${this.videoWidth}px,  videoHeight: ${this.videoHeight}px`)}),s.addEventListener(\"resize\",()=>{if(console.log(`Remote video size changed to ${s.videoWidth}x${s.videoHeight}`),i){const e=window.performance.now()-i;console.log(\"Setup time: \"+e.toFixed(3)+\"ms\"),i=null}});const u={offerToReceiveAudio:1,offerToReceiveVideo:1};function g(e){return e===d?\"pc1\":\"pc2\"}function f(e){console.log(`Failed to create session description: ${e.toString()}`)}function p(e){console.log(`${g(e)} setLocalDescription complete`)}function m(e){console.log(`${g(e)} setRemoteDescription complete`)}function v(e){console.log(`Failed to set session description: ${e.toString()}`)}function h(e){s.srcObject!==e.streams[0]&&(s.srcObject=e.streams[0],console.log(\"pc2 received remote stream\"))}async function y(e,t){try{await function(e){return e===d?r:d}(e).addIceCandidate(t.candidate),function(e){console.log(`${g(e)} addIceCandidate success`)}(e)}catch(t){!function(e,t){console.log(`${g(e)} failed to add ICE Candidate: ${t.toString()}`)}(e,t)}console.log(`${g(e)} ICE candidate:\\n${t.candidate?t.candidate.candidate:\"(null)\"}`)}function b(e,t){e&&(console.log(`${g(e)} ICE state: ${e.iceConnectionState}`),console.log(\"ICE state change event: \",t))}}]);","extractedComments":[]}